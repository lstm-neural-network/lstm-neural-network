<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>LSTM Recurrent Neural Networks - 4&nbsp; Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Conclusion.html" rel="next">
<link href="./methodology.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analysis</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">LSTM Recurrent Neural Networks</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./methodology.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methodology</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Analysis.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Conclusion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>#Downloading the Data</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install tensorflow</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install keras</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install matplotlib</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Stocks that we'll be analyzing</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>AAPL <span class="op">=</span> [<span class="st">'AAPL'</span>]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>GM <span class="op">=</span> [<span class="st">'GM'</span>]</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Set start and end date for the data pull</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#We want to look at the past 5 years, so we'll pull the previous 5 years of data</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>end_time <span class="op">=</span> datetime.now()</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> datetime(end_time.year <span class="op">-</span> <span class="dv">5</span>, end_time.month, end_time.day)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#download the stocks we want to model </span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>AAPL <span class="op">=</span> yf.download(AAPL, start_time, end_time)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>GM <span class="op">=</span> yf.download(GM, start_time, end_time)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding additional columns</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>AAPL[<span class="st">'pct_change'</span>] <span class="op">=</span> AAPL.Close.pct_change(periods <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>AAPL[<span class="st">'EMA20'</span>] <span class="op">=</span> AAPL[<span class="st">'Close'</span>].ewm(span<span class="op">=</span><span class="dv">20</span>).mean()</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>GM[<span class="st">'pct_change'</span>] <span class="op">=</span> GM.Close.pct_change(periods <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>GM[<span class="st">'EMA20'</span>] <span class="op">=</span> GM[<span class="st">'Close'</span>].ewm(span<span class="op">=</span><span class="dv">20</span>).mean()</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#AAPL.head(10)</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation Analysis </span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#correlation = AAPL.corr()</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#print(correlation['Close'].sort_values(ascending=False))</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining X and y variable</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> AAPL[[<span class="st">'Open'</span>,<span class="st">'High'</span>, <span class="st">'Low'</span>, <span class="st">'Volume'</span>]]</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>X1.head(<span class="dv">10</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> AAPL[<span class="st">'Close'</span>]</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>y1.head(<span class="dv">10</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> GM[[<span class="st">'Open'</span>,<span class="st">'High'</span>, <span class="st">'Low'</span>, <span class="st">'Volume'</span>]]</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>X2.head(<span class="dv">10</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> GM[<span class="st">'Close'</span>]</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>y2.head(<span class="dv">10</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting to array</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> X1.to_numpy()</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> y1.to_numpy()</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> X2.to_numpy()</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> y2.to_numpy()</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co">#Splitting our data into 80/20 training/testing sets</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>LSTM_Xtrain1, LSTM_Xtest1, LSTM_ytrain1, LSTM_ytest1 <span class="op">=</span> train_test_split(X1, y1, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>LSTM_Xtrain2, LSTM_Xtest2, LSTM_ytrain2, LSTM_ytest2 <span class="op">=</span> train_test_split(X2, y2, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(LSTM_Xtrain1)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(LSTM_Xtrain2)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked LSTM model </span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> keras <span class="im">as</span> ke</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> LSTM</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dropout</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="co">#Apple model</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>LSTM_modelApple <span class="op">=</span> ke.Sequential()</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>LSTM_modelApple.add(LSTM(<span class="dv">128</span>, return_sequences<span class="op">=</span><span class="va">True</span>, input_shape<span class="op">=</span>(LSTM_Xtrain1.shape[<span class="dv">1</span>], <span class="dv">1</span>)))</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>LSTM_modelApple.add(LSTM(<span class="dv">64</span>, return_sequences<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>LSTM_modelApple.add(Dense(<span class="dv">25</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>LSTM_modelApple.add(Dense(<span class="dv">1</span>))</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="co">#GM model</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>LSTM_modelGM <span class="op">=</span> ke.Sequential()</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>LSTM_modelGM.add(LSTM(<span class="dv">128</span>, return_sequences<span class="op">=</span><span class="va">True</span>, input_shape<span class="op">=</span>(LSTM_Xtrain2.shape[<span class="dv">1</span>], <span class="dv">1</span>)))</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>LSTM_modelGM.add(LSTM(<span class="dv">64</span>, return_sequences<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>LSTM_modelGM.add(Dense(<span class="dv">25</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>LSTM_modelGM.add(Dense(<span class="dv">1</span>))</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>LSTM_modelApple.summary()</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>LSTM_modelGM.summary()</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>LSTM_modelApple.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'rmsprop'</span> , loss<span class="op">=</span> <span class="st">'mean_squared_error'</span>)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>LSTM_modelGM.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'rmsprop'</span> , loss<span class="op">=</span> <span class="st">'mean_squared_error'</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>history1 <span class="op">=</span> LSTM_modelApple.fit(LSTM_Xtrain1, LSTM_ytrain1, batch_size<span class="op">=</span><span class="dv">32</span>, epochs<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>history2 <span class="op">=</span> LSTM_modelGM.fit(LSTM_Xtrain2, LSTM_ytrain2, batch_size<span class="op">=</span><span class="dv">32</span>,epochs<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>loss_test1<span class="op">=</span> LSTM_modelApple.evaluate(LSTM_Xtest1, LSTM_ytest1)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>loss_test2 <span class="op">=</span> LSTM_modelApple.evaluate(LSTM_Xtest2, LSTM_ytest2)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>predictions1 <span class="op">=</span> LSTM_modelApple.predict(LSTM_Xtest1)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>predictions1.reshape(<span class="dv">252</span>,)</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>predictions2 <span class="op">=</span> LSTM_modelGM.predict(LSTM_Xtest2)</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>predictions2.reshape(<span class="dv">252</span>,)</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="co">#Predict 11/03/23 price = $177.57</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>In_featuresApple <span class="op">=</span> np.array([[<span class="fl">175.52</span>, <span class="fl">177.78</span>, <span class="fl">175.46</span>, <span class="dv">76083900</span>]])</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>LSTM_modelApple.predict(In_featuresApple)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The predicted stock price for 11/03/23 is $ "</span>, LSTM_modelApple.predict(In_featuresApple),<span class="st">"."</span>, <span class="st">" The actual stock price for 11/03/23 is $177.57"</span>)</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the first 50 predictions vs the actual y values</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>LSTM_ytest1 <span class="op">=</span> LSTM_ytest1.reshape(<span class="dv">252</span>, <span class="dv">1</span>)</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>LSTM_ytest2 <span class="op">=</span> LSTM_ytest2.reshape(<span class="dv">252</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[*********************100%%**********************]  1 of 1 completed</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[*********************100%%**********************]  1 of 1 completed</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1.72259995e+02 1.73630005e+02 1.70820007e+02 4.95946000e+07]
 [1.61529999e+02 1.62470001e+02 1.61270004e+02 4.95017000e+07]
 [1.14570000e+02 1.15230003e+02 1.10000000e+02 1.80860300e+08]
 ...
 [1.57970001e+02 1.58490005e+02 1.55979996e+02 4.59922000e+07]
 [6.11274986e+01 6.12000008e+01 6.04524994e+01 6.92752000e+07]
 [1.52570007e+02 1.53100006e+02 1.50779999e+02 6.98583000e+07]]
[[3.20499992e+01 3.21899986e+01 3.13099995e+01 1.30609000e+07]
 [3.62500000e+01 3.64799995e+01 3.58699989e+01 9.30020000e+06]
 [3.02999992e+01 3.05699997e+01 2.98700008e+01 1.36387000e+07]
 ...
 [3.44599991e+01 3.46500015e+01 3.40499992e+01 1.22142000e+07]
 [3.66199989e+01 3.67700005e+01 3.57400017e+01 6.71880000e+06]
 [4.09000015e+01 4.16100006e+01 4.07700005e+01 1.42857000e+07]]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> lstm (LSTM)                 (None, 4, 128)            66560     </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> lstm_1 (LSTM)               (None, 64)                49408     </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense (Dense)               (None, 25)                1625      </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_1 (Dense)             (None, 1)                 26        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 117619 (459.45 KB)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 117619 (459.45 KB)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0 (0.00 Byte)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> lstm_2 (LSTM)               (None, 4, 128)            66560     </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> lstm_3 (LSTM)               (None, 64)                49408     </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_2 (Dense)             (None, 25)                1625      </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_3 (Dense)             (None, 1)                 26        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 117619 (459.45 KB)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 117619 (459.45 KB)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0 (0.00 Byte)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 5:14 - loss: 17850.5234</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 15644.5586  </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 15900.7969</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 15772.7217</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 14881.7344</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 14459.6035</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 14024.1689</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 13654.3691</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 13179.0322</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>27/32 [========================&gt;.....] - ETA: 0s - loss: 13086.1475</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>30/32 [===========================&gt;..] - ETA: 0s - loss: 12742.4707</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 11s 21ms/step - loss: 12606.0127</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 2/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 8693.1504</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 9772.4922</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 9170.6875</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 9002.3066</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 8641.8262</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 8623.2207</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 8586.4473</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 8393.2275</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 8248.5586</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 8114.9932</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 7880.6470</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 7868.6719</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 3/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 5713.8296</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 5922.1846</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 5842.7729</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 5897.3521</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 5945.6724</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 5823.5977</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 5688.9473</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 5461.6406</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>24/32 [=====================&gt;........] - ETA: 0s - loss: 5356.8721</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>27/32 [========================&gt;.....] - ETA: 0s - loss: 5271.1655</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>30/32 [===========================&gt;..] - ETA: 0s - loss: 5127.4526</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 22ms/step - loss: 5041.5947</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 4/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 3034.0632</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 3556.1946</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 3487.9436</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 3493.4324</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 3464.1040</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 3481.0308</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 3361.7490</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 3292.1914</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 3271.4468</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 3220.5398</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 3095.1345</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 3089.4897</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 5/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 2102.0312</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 1699.1125</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 1639.6678</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 1590.3613</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 1472.7759</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 1409.2086</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 1361.2793</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 1301.4639</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 1238.5306</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 1204.3831</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 1164.0266</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 1155.6792</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 6/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 619.1258</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 828.0585</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 856.7490</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 716.8060</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 632.5975</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 573.7088</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 547.6782</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 518.9468</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 487.2103</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 465.4656</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 451.3146</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 448.6695</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 7/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 347.0085</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 3/32 [=&gt;............................] - ETA: 0s - loss: 296.7923</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 5/32 [===&gt;..........................] - ETA: 0s - loss: 245.1817</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 8/32 [======&gt;.......................] - ETA: 0s - loss: 219.7252</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>11/32 [=========&gt;....................] - ETA: 0s - loss: 223.0440</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>14/32 [============&gt;.................] - ETA: 0s - loss: 249.5138</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>17/32 [==============&gt;...............] - ETA: 0s - loss: 227.5485</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>20/32 [=================&gt;............] - ETA: 0s - loss: 217.0573</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>23/32 [====================&gt;.........] - ETA: 0s - loss: 211.6015</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>26/32 [=======================&gt;......] - ETA: 0s - loss: 210.4924</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>29/32 [==========================&gt;...] - ETA: 0s - loss: 203.7533</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - ETA: 0s - loss: 219.6363</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 21ms/step - loss: 219.6363</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 8/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 213.4327</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 133.0811</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 108.0463</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 118.1999</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 159.1105</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 139.9008</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 139.5156</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 135.0309</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 128.4955</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 141.6774</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 135.5284</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 134.5963</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 9/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 55.0438</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 107.0401</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 94.6184 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 155.8024</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 129.3708</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 112.3770</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 112.7955</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 131.7285</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 126.4455</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 119.4833</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 113.7246</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 113.8472</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 10/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 127.4089</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 76.9268 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 54.0622</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 45.3098</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 103.6735</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 98.6646 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 88.8192</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 80.0932</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 81.8757</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 88.9611</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 89.0983</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 88.6498</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 4:48 - loss: 1773.3213</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 1537.0836  </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 1352.1608</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 1211.0248</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 1084.7893</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 957.5520 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 857.1149</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 774.2867</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 708.5995</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 652.3316</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 606.9402</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 10s 21ms/step - loss: 600.7240</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 2/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 80.7045</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 121.5190</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 145.9119</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 132.5465</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 119.7521</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 115.8692</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 113.3471</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 108.6190</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 108.2770</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 108.7407</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 109.9512</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 109.6814</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 3/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 68.2729</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 78.9483</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 83.9708</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 93.3768</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 92.0741</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 93.3890</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 90.5298</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 89.4009</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 85.3424</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 80.2891</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 78.1326</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 77.3099</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 4/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 45.8507</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 23.3488</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 23.6393</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 24.5916</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 21.8899</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 19.2271</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 19.8572</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 18.3936</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 16.5420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 15.6097</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 15.4025</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 15.2536</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 5/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 4.4074</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 5.7328</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 6/32 [====&gt;.........................] - ETA: 0s - loss: 5.1036</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 9/32 [=======&gt;......................] - ETA: 0s - loss: 6.1751</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>11/32 [=========&gt;....................] - ETA: 0s - loss: 10.4035</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 9.9158 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 8.3925</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 7.2127</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 6.7097</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 8.8793</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 8.5070</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 7.8676</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 22ms/step - loss: 7.8354</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 6/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 3.7876</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 4.6281</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 5.3822</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 8.0719</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 7.0538</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 6.0123</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 5.7606</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 7.2321</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 7.8451</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 7.1664</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 6.5498</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 20ms/step - loss: 6.4707</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 7/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 1.7170</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 1.7070</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 9.4125</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 8.4469</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 6.7784</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 5.7227</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 6.9527</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 8.6763</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 7.7715</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 7.0259</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 6.4263</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 21ms/step - loss: 6.3665</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 8/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 5.3137</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 9.4058</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 8.6938</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 6.4935</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 5.7911</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 6.1708</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 7.2777</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 7.3643</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 6.6420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 6.1092</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 5.9298</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 21ms/step - loss: 5.9926</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 9/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 15.8345</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 9.6827 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 8.1831</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 6.1453</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 5.2620</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 5.0287</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 6.4515</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 5.9791</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>24/32 [=====================&gt;........] - ETA: 0s - loss: 5.5776</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>26/32 [=======================&gt;......] - ETA: 0s - loss: 5.2321</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>29/32 [==========================&gt;...] - ETA: 0s - loss: 4.9010</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - ETA: 0s - loss: 5.6360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 22ms/step - loss: 5.6360</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 10/10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 1/32 [..............................] - ETA: 0s - loss: 10.8725</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 4/32 [==&gt;...........................] - ETA: 0s - loss: 5.5644 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> 7/32 [=====&gt;........................] - ETA: 0s - loss: 3.6194</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>10/32 [========&gt;.....................] - ETA: 0s - loss: 2.9519</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>13/32 [===========&gt;..................] - ETA: 0s - loss: 4.3095</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/32 [==============&gt;...............] - ETA: 0s - loss: 4.6350</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>19/32 [================&gt;.............] - ETA: 0s - loss: 4.1252</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>22/32 [===================&gt;..........] - ETA: 0s - loss: 4.0169</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>25/32 [======================&gt;.......] - ETA: 0s - loss: 4.1873</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>28/32 [=========================&gt;....] - ETA: 0s - loss: 4.4110</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>31/32 [============================&gt;.] - ETA: 0s - loss: 4.3664</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>32/32 [==============================] - 1s 21ms/step - loss: 4.3573</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/8 [==&gt;...........................] - ETA: 14s - loss: 41.7166</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>7/8 [=========================&gt;....] - ETA: 0s - loss: 56.9148 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>8/8 [==============================] - 2s 10ms/step - loss: 55.5127</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/8 [==&gt;...........................] - ETA: 0s - loss: 10.9799</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>7/8 [=========================&gt;....] - ETA: 0s - loss: 13.5169</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>8/8 [==============================] - 0s 10ms/step - loss: 13.5051</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/8 [==&gt;...........................] - ETA: 16s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>7/8 [=========================&gt;....] - ETA: 0s </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>8/8 [==============================] - 2s 9ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/8 [==&gt;...........................] - ETA: 13s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>7/8 [=========================&gt;....] - ETA: 0s </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>8/8 [==============================] - 2s 10ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 61ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 54ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The predicted stock price for 11/03/23 is $  [[164.19055]] .  The actual stock price for 11/03/23 is $177.57</code></pre>
</div>
</div>
<p><strong>Apple Stock Price Prediction</strong></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>plt.plot(LSTM_ytest1[:<span class="dv">50</span>], <span class="st">'red'</span>, label <span class="op">=</span> <span class="st">'AAPL Stock Price'</span>)</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>plt.plot(predictions1[:<span class="dv">50</span>], color <span class="op">=</span> <span class="st">'green'</span>, label <span class="op">=</span> <span class="st">'Predicted AAPL Stock Price'</span>)</span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'AAPL Stock Price Prediction'</span>)</span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time'</span>)</span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'AAPL Stock Price'</span>)</span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Analysis_files/figure-html/cell-3-output-1.png" width="593" height="449"></p>
</div>
</div>
<p><strong>GM Stock Price Prediction</strong></p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>plt.plot(LSTM_ytest2[:<span class="dv">50</span>], <span class="st">'red'</span>, label <span class="op">=</span> <span class="st">'GM Stock Price'</span>)</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a>plt.plot(predictions2[:<span class="dv">50</span>], color <span class="op">=</span> <span class="st">'green'</span>, label <span class="op">=</span> <span class="st">'Predicted GM Stock Price'</span>)</span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'GM Stock Price Prediction'</span>)</span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time'</span>)</span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'GM Stock Price'</span>)</span>
<span id="cb322-6"><a href="#cb322-6" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb322-7"><a href="#cb322-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb322-8"><a href="#cb322-8" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Analysis_files/figure-html/cell-4-output-1.png" width="585" height="449"></p>
</div>
</div>
<p><strong>Training loss for Apple</strong></p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history1.history[<span class="st">'loss'</span>], label<span class="op">=</span><span class="st">'Loss'</span>)</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training Loss for Apple'</span>)</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Analysis_files/figure-html/cell-5-output-1.png" width="610" height="449"></p>
</div>
</div>
<p><strong>Training loss plot for GM</strong></p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history2.history[<span class="st">'loss'</span>], label<span class="op">=</span><span class="st">'Loss'</span>)</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training Loss for GM'</span>)</span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Analysis_files/figure-html/cell-6-output-1.png" width="593" height="449"></p>
</div>
</div>
<p>The following table illustrates the fact that different numbers of epochs can yield different results when it comes to training. Training for an excessive number of epochs can cause overfitting, where the model begins to memorize the training data instead of generalizing well to new, unseen data, and underfitting, where the model fails to capture the underlying patterns in the data. Achieving the best training outcomes requires finding the correct balance.</p>
<table class="table">
<thead>
<tr class="header">
<th>Epochs</th>
<th>Apple</th>
<th>GM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>25</strong></td>
<td><img src="images/aapl25.png" class="img-fluid"></td>
<td><img src="images/GM25.png" class="img-fluid"></td>
</tr>
<tr class="even">
<td><strong>50</strong></td>
<td><img src="images/aapl50.png" class="img-fluid"></td>
<td><img src="images/GM50.png" class="img-fluid"></td>
</tr>
<tr class="odd">
<td><strong>100</strong></td>
<td><img src="images/aapl100.png" class="img-fluid"></td>
<td><img src="images/GM100.png" class="img-fluid"></td>
</tr>
<tr class="even">
<td><strong>150</strong></td>
<td><img src="images/aapl150.png" class="img-fluid"></td>
<td><img src="images/GM150.png" class="img-fluid"></td>
</tr>
<tr class="odd">
<td><strong>200</strong></td>
<td><img src="images/aapl200-01.png" class="img-fluid"></td>
<td><img src="images/GM200.png" class="img-fluid"></td>
</tr>
</tbody>
</table>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./methodology.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methodology</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Conclusion.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>